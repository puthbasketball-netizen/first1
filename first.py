import streamlit as st
import pandas as pd
import numpy as np

# ---------------------- é¡µé¢é…ç½® ----------------------
st.set_page_config(
    page_title="å—å®ç¾é£Ÿæ•°æ®ä»ªè¡¨ç›˜",
    layout="centered",
    initial_sidebar_state="collapsed"
)

# ---------------------- æ ¸å¿ƒæ•°æ®å®šä¹‰ ----------------------
# 1. é¤å…åŸºç¡€ä¿¡æ¯ï¼ˆ5å®¶ä¸åŒç±»å‹ã€ä»·æ ¼å·®å¼‚å¤§ï¼‰
restaurants = {
    "é¤å…åç§°": ["é‚•åŸç²‰éƒ½", "å£®ä¹¡é…¸å˜¢é¦†", "ä¸œç›Ÿæµ·é²œåŸ", "è€å‹å±…ç§å¨", "æ³•å¼è½»é£ŸåŠ"],
    "ç±»å‹": ["å¿«é¤", "å°åƒ", "æµ·é²œ", "ç§æˆ¿èœ", "è¥¿é¤"],
    "è¯„åˆ†": [4.1, 4.3, 4.6, 4.8, 4.4],
    "äººå‡æ¶ˆè´¹(å…ƒ)": [12, 8, 120, 88, 65],
    "latitude": [22.8170, 22.8250, 22.7980, 22.8050, 22.8210],
    "longitude": [108.3500, 108.3320, 108.3200, 108.3450, 108.3600]
}
df_rest = pd.DataFrame(restaurants)

# 2. ç”¨é¤é«˜å³°æ—¶æ®µæ•°æ®
hours = [10, 11, 12, 13, 17, 18, 19, 20]
peak_hours = {
    "æ—¶æ®µ(æ—¶)": hours,
    "é‚•åŸç²‰éƒ½": [30, 80, 95, 60, 40, 75, 85, 50],
    "å£®ä¹¡é…¸å˜¢é¦†": [20, 50, 70, 40, 30, 60, 75, 45],
    "ä¸œç›Ÿæµ·é²œåŸ": [10, 20, 30, 25, 40, 80, 90, 60],
    "è€å‹å±…ç§å¨": [5, 15, 25, 20, 35, 70, 85, 55],
    "æ³•å¼è½»é£ŸåŠ": [8, 20, 30, 25, 30, 50, 65, 40]
}
df_peak = pd.DataFrame(peak_hours)

# ç»Ÿä¸€å›¾è¡¨é¢œè‰²ï¼ˆä¸€ä¸€å¯¹åº”é¤å…ï¼‰
chart_colors = ["#FF9999", "#66B2FF", "#99FF99", "#FFCC99", "#FF99CC"]

# ---------------------- ç«–å‘æ ¸å¿ƒå¸ƒå±€ ----------------------
st.title("ğŸœ å—å®ç¾é£Ÿæ ¸å¿ƒæ•°æ®ä»ªè¡¨ç›˜")
st.markdown("---")

# 1. é¤å…ä½ç½®åˆ†å¸ƒåœ°å›¾
st.header("ğŸ“ é¤å…åœ°ç†ä½ç½®åˆ†å¸ƒ")
st.map(
    df_rest.rename(columns={"latitude": "lat", "longitude": "lon"}),
    zoom=12,
    use_container_width=True
)
st.markdown("---")

# 2. é¤å…è¯„åˆ†å¯¹æ¯”
st.header("â­ é¤å…è¯„åˆ†å¯¹æ¯”")
st.bar_chart(
    df_rest.set_index("é¤å…åç§°")["è¯„åˆ†"],
    y_label="è¯„åˆ†ï¼ˆæ»¡åˆ†5åˆ†ï¼‰",
    color="#FF6B6B",
    use_container_width=True,
    height=400
)
st.markdown("---")

# 3. ä¸åŒç±»å‹é¤å…ä»·æ ¼å¯¹æ¯”
st.header("ğŸ’° ä¸åŒç±»å‹é¤å…äººå‡æ¶ˆè´¹")
st.bar_chart(
    df_rest.set_index("ç±»å‹")["äººå‡æ¶ˆè´¹(å…ƒ)"],
    y_label="äººå‡æ¶ˆè´¹ï¼ˆå…ƒï¼‰",
    color="#4ECDC4",
    use_container_width=True,
    height=400
)
st.markdown("---")

# 4. ç”¨é¤é«˜å³°æ—¶æ®µï¼ˆåˆ†é¤å…+é¢œè‰²æ ‡æ³¨ï¼‰
st.header("â° é¤å…ç”¨é¤é«˜å³°æ—¶æ®µ")
st.area_chart(
    df_peak.set_index("æ—¶æ®µ(æ—¶)"),
    y_label="å®¢æµé‡ï¼ˆäººæ¬¡ï¼‰",
    color=chart_colors,
    use_container_width=True,
    height=500
)
st.caption("ğŸ” é¢œè‰²å¯¹åº”ï¼šé‚•åŸç²‰éƒ½(æµ…çº¢)ã€å£®ä¹¡é…¸å˜¢é¦†(æµ…è“)ã€ä¸œç›Ÿæµ·é²œåŸ(æµ…ç»¿)ã€è€å‹å±…ç§å¨(æµ…é»„)ã€æ³•å¼è½»é£ŸåŠ(æµ…ç²‰)")
